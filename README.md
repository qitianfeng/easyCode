# 完整开发流程 MCP 工具链

## 🎯 项目概述

这是一套完整的软件开发流程 MCP (Model Context Protocol) 工具链，覆盖从产品需求分析到代码测试的全流程，特别强调**智能架构识别**，确保生成的代码完美契合现有项目架构。

## 🔄 核心理念

### 问题背景
传统的代码生成工具使用固定模板，无法适应不同项目的架构差异，导致：
- 生成的代码与现有架构不匹配
- 需要大量手工调整
- 代码风格不一致
- 难以融入现有项目

### 解决方案
我们的工具链采用**智能架构识别**方案：
1. **先分析**：智能识别现有项目的具体架构模式
2. **再生成**：基于识别结果生成完全匹配的代码
3. **零调整**：生成的代码无需修改，直接可用

## 📁 项目结构

```
project-root/
├── 📚 docs/                           # 文档目录
│   ├── 代码开发规则规范.md              # 开发规范文档
│   ├── 完整开发流程使用指南.md          # 详细使用指南
│   └── OceanBase_MCP_配置教程.md       # 数据库配置教程
│
├── 🛠️ mcp-tools/                      # MCP工具目录
│   ├── 01-requirements/               # 需求分析阶段
│   │   ├── 需求分析MCP工具.py
│   │   └── 用户故事生成MCP工具.py
│   ├── 02-design/                     # 设计文档阶段
│   │   └── 架构设计MCP工具.py
│   ├── 03-architecture/               # 架构识别阶段
│   │   └── 项目架构识别MCP工具.py
│   ├── 04-generation/                 # 代码生成阶段
│   │   ├── 智能代码生成MCP工具.py
│   │   └── 代码规范检查MCP工具.py
│   └── 05-testing/                    # 测试阶段
│       └── 测试生成MCP工具.py
│
├── ⚙️ config/                         # 配置文件目录
│   └── 完整开发流程MCP配置.json         # 主配置文件
│
└── 📋 templates/                      # 代码模板目录
```

## 🔄 三种开发流程选择

### 流程A：需求到设计文档（5个阶段）
```
产品需求解析 → 需求分析 → 用户故事生成 → 架构设计 → 设计文档生成
     ↓           ↓          ↓           ↓          ↓
  需求内容提取   功能需求    用户故事     系统架构    完整技术文档
  多种输入方式   非功能需求   Sprint计划   技术栈选择   Markdown格式
  自动解析      业务规则     验收标准     部署方案     可复用文档
```

### 流程B：完整开发流程（5个阶段）
```
阶段1: 需求分析     → 阶段2: 架构设计     → 阶段3: 架构识别
   ↓                    ↓                    ↓
产品需求文档         系统架构设计         现有项目分析
用户故事生成         技术栈推荐           编码规范提取
Sprint计划          部署方案             模块放置规则
   ↓                    ↓                    ↓
阶段4: 代码生成     → 阶段5: 测试验证
   ↓                    ↓
业务代码生成         单元测试生成
配置文件生成         集成测试生成
数据库脚本           API测试生成
```

### 流程C：设计文档开发流程（3个阶段）
```
设计文档解析     → 现有架构识别     → 代码生成
   ↓                ↓                ↓
技术设计提取      项目架构分析      智能代码生成
模块划分识别      编码规范提取      质量检查
API接口解析      目录结构分析      测试用例生成
```

**适用场景**：
- ✅ **流程A**：需要生成技术设计文档的项目（推荐）
- ✅ **流程B**：从产品需求直接到代码的项目
- ✅ **流程C**：已有技术设计文档的项目

## 🏗️ 支持的架构模式

### 智能识别的架构类型

#### 1. **分层架构 (Layered Architecture)**
```
Controller Layer (表现层)
    ↓
Service Layer (业务逻辑层)
    ↓
Repository Layer (数据访问层)
    ↓
Entity Layer (实体层)
```

#### 2. **微服务架构 (Microservice Architecture)**
```
Service A    Service B    Service C
    ↓            ↓            ↓
Database A   Database B   Database C
```

#### 3. **六边形架构 (Hexagonal Architecture)**
```
    Web Adapter
         ↓
Application Service ← → Domain Service
         ↓
Repository Adapter
```

#### 4. **领域驱动设计 (Domain Driven Design)**
```
Application Layer
    ↓
Domain Layer (Aggregates, Entities, Value Objects)
    ↓
Infrastructure Layer
```

## 📋 产品需求输入方式

我们支持多种产品需求输入方式，适应不同团队的工作习惯：

### 🔗 方式1：腾讯 CodeSign 链接
```
用户：我有一个CodeSign需求链接
AI：@requirements-document-parser 解析CodeSign链接...
✅ 自动提取需求内容
✅ 识别功能需求和用户角色
```

### 📸 方式2：截图文件夹
```
用户：我把需求截图放在文件夹里了
AI：@requirements-document-parser 批量解析截图...
✅ OCR文字识别
✅ 支持中英文混合
✅ 自动合并多张截图内容
```

### 📄 方式3：文档文件
```
支持格式：Markdown(.md)、Word(.docx)、文本(.txt)、JSON(.json)
用户：我有一个需求文档
AI：@requirements-document-parser 解析文档文件...
✅ 自动识别文档结构
✅ 提取需求要素
```

### ✏️ 方式4：直接文本输入
```
用户：我直接说需求内容
AI：@requirements-document-parser 解析文本内容...
✅ 快速需求分析
✅ 适合简单需求
```

## 📄 设计文档输入方式

当您已有开发设计文档时，可以直接跳过需求分析阶段：

### 📋 方式1：设计文档文件
```
用户：我有技术设计文档
AI：@design-document-parser 解析设计文档...
✅ 自动提取架构设计
✅ 识别数据库设计
✅ 解析API接口定义
```

### 🔗 方式2：设计文档URL
```
支持：Confluence、Notion、Wiki等在线文档
AI：@design-document-parser 解析在线设计文档...
✅ 自动获取最新设计
✅ 团队协作友好
```

### 📸 方式3：设计截图
```
用户：设计文档截图文件夹
AI：@design-document-parser OCR识别设计内容...
✅ 识别架构图
✅ 提取技术方案
```

## 🚀 快速开始

### 1. 配置 Trae IDE
将 `config/完整开发流程MCP配置.json` 添加到 Trae IDE 的 MCP 配置中。

### 2. 使用场景

#### 场景A：需求到设计文档（推荐）
```
用户：我有一个CodeSign需求链接，先帮我生成技术设计文档

AI执行流程A：
1. 📋 需求解析：@requirements-document-parser
   - 解析CodeSign链接内容
   - 提取功能需求、用户角色、业务规则

2. 📝 需求分析：@requirements-analyzer
   - 生成功能需求列表
   - 识别非功能需求
   - 提取业务规则

3. 📖 用户故事生成：@user-story-generator
   - 创建用户故事
   - 规划Sprint计划

4. 🏗️ 架构设计：@architecture-designer
   - 设计系统架构
   - 推荐技术栈

5. 📄 设计文档生成：@design-document-generator
   - 生成完整技术设计文档
   - 包含架构、数据库、API、模块设计
   - 输出Markdown格式文档

输出：完整的技术设计文档，可用于后续开发或团队审查
```

#### 场景B：现有项目新功能开发
```
用户：我有一个CodeSign需求链接，要在现有Spring Boot项目中添加订单管理功能

AI执行流程B：
1. 📋 需求解析：@requirements-document-parser
   - 解析CodeSign链接内容
   - 提取功能需求、用户角色、业务规则

2. 🔍 架构识别：@project-architecture-analyzer
   - 识别分层架构（置信度85%）
   - 提取包结构：com.example.project.{controller,service,repository}
   - 分析命名约定：PascalCase类名，camelCase方法名

3. ⚙️ 智能生成：@intelligent-code-generator
   - OrderController.java (遵循现有REST API风格)
   - OrderService.java (遵循现有事务管理模式)
   - OrderRepository.java (遵循现有JPA查询模式)

4. ✅ 质量检查：@code-standard-checker
   - 代码风格100%一致
   - 架构模式完全匹配

5. 🧪 测试生成：@test-generator
   - 单元测试、集成测试、API测试
```

#### 场景C：设计文档开发
```
用户：我有一个完整的技术设计文档，直接帮我生成代码

AI执行流程C：
1. 📄 设计文档解析：@design-document-parser
   - 提取架构设计、数据库设计、API设计
   - 识别模块划分和技术栈

2. 🔍 现有架构识别：@project-architecture-analyzer
   - 识别现有项目架构模式
   - 提取编码规范和目录结构

3. ⚙️ 智能代码生成：@intelligent-code-generator
   - 基于设计文档生成完整模块
   - 符合现有项目架构和规范

4. ✅ 质量检查和测试生成
   - 代码质量检查
   - 自动生成测试用例
```

#### 场景D：全新项目开发
```
用户：我要开发一个电商系统

AI执行完整5阶段流程：
1. 需求分析 → 2. 架构设计 → 3. 跳过架构识别 → 4. 代码生成 → 5. 测试生成
```

## 🎯 核心优势

### 1. **智能架构适应**
- 自动识别项目架构模式
- 提取现有编码规范
- 生成100%匹配的代码

### 2. **全流程覆盖**
- 需求分析 → 设计文档 → 代码生成 → 测试验证
- 每个阶段都有专门的MCP工具
- 工具间数据流转无缝衔接

### 3. **多架构支持**
- 分层架构、微服务架构
- 六边形架构、DDD架构
- 可扩展支持自定义架构

### 4. **高质量保证**
- 代码规范检查
- 自动测试生成
- 文档自动生成

## 📊 效果评估

### 开发效率提升
- **架构识别**：自动化程度95%
- **代码生成**：提升效率80%
- **测试创建**：自动生成覆盖率85%

### 代码质量保证
- **架构一致性**：100%符合现有架构
- **编码规范**：100%符合项目规范
- **文档完整性**：自动生成完整文档

## 📚 文档导航

### 核心文档
- [📖 完整开发流程使用指南](docs/完整开发流程使用指南.md) - 详细使用说明
- [📋 产品需求输入方式指南](docs/产品需求输入方式指南.md) - 需求输入方式详解
- [📄 设计文档输入方式指南](docs/设计文档输入方式指南.md) - 设计文档输入详解
- [🔧 OceanBase MCP 配置教程](docs/OceanBase_MCP_配置教程.md) - 数据库配置

### 提示词文档
- [💬 所有场景提示词大全](docs/所有场景提示词大全.md) - 完整的提示词集合
- [⚡ 提示词快速参考](docs/提示词快速参考.md) - 常用提示词速查

### 技术文档
- [🏗️ 智能架构识别开发流程](docs/智能架构识别开发流程.md) - 架构识别详解
- [📁 文件结构说明](文件结构说明.md) - 项目结构说明

## ⚙️ 配置文件

### 主配置文件
- `config/完整开发流程MCP配置.json` - 包含所有MCP工具的配置

### 工作流配置
系统预定义了四个工作流：
1. **需求到设计文档** - 从产品需求生成技术设计文档（推荐）
2. **完整开发流程** - 从产品需求直接到代码的全流程
3. **设计文档开发** - 从现有技术设计文档开始开发
4. **新功能开发** - 适用于现有项目的功能扩展

## 🔧 自定义扩展

### 添加新架构模式
1. 在 `项目架构识别MCP工具.py` 中添加识别逻辑
2. 在 `智能代码生成MCP工具.py` 中添加生成逻辑
3. 在 `templates/` 中添加对应模板

### 调整识别规则
```python
# 在架构识别工具中调整
CONFIDENCE_THRESHOLD = 60  # 置信度阈值
```

## 🚨 注意事项

1. **首次使用**：建议先在测试项目中验证
2. **架构识别**：确保项目结构完整，代码示例充足
3. **置信度检查**：验证架构识别的置信度是否足够
4. **持续优化**：根据使用反馈优化识别规则和生成模板

## 🤝 贡献指南

欢迎贡献代码和建议！请：
1. Fork 项目
2. 创建功能分支
3. 提交 Pull Request

## 📄 许可证

本项目采用 MIT 许可证。

---

**这套智能架构识别的完整开发流程 MCP 工具链，让您的代码生成不再是固定模板的简单套用，而是真正理解项目架构的智能创造！**
