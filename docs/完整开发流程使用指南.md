# 完整开发流程 MCP 工具链使用指南

## 📁 项目结构

```
project-root/
├── 📚 docs/                           # 文档目录
│   ├── 代码开发规则规范.md              # 开发规范文档
│   ├── 完整开发流程使用指南.md          # 本文档
│   ├── OceanBase_MCP_配置教程.md       # 数据库配置教程
│   └── 其他文档...
│
├── 🛠️ mcp-tools/                      # MCP工具目录
│   ├── 01-requirements/               # 需求分析阶段
│   │   ├── 需求分析MCP工具.py
│   │   └── 用户故事生成MCP工具.py
│   ├── 02-design/                     # 设计文档阶段
│   │   └── 架构设计MCP工具.py
│   ├── 03-architecture/               # 架构识别阶段
│   │   └── 项目架构识别MCP工具.py
│   ├── 04-generation/                 # 代码生成阶段
│   │   ├── 智能代码生成MCP工具.py
│   │   ├── 代码生成MCP工具.py
│   │   └── 代码规范检查MCP工具.py
│   └── 05-testing/                    # 测试阶段
│       └── 测试生成MCP工具.py
│
├── ⚙️ config/                         # 配置文件目录
│   └── 完整开发流程MCP配置.json         # 主配置文件
│
└── 📋 templates/                      # 代码模板目录
```

## 🔄 完整开发流程

### 流程概述
```
需求分析 → 架构设计 → 现有架构识别 → 代码生成 → 测试验证
```

## 🚀 使用场景

### 场景1：全新项目开发

#### 完整流程演示
```
用户：我要开发一个电商订单管理系统

第1步：需求分析
AI：@requirements-analyzer 我来分析您的需求...

分析结果：
✅ 功能需求：12个
   - 订单创建、查询、更新、取消
   - 支付处理、库存管理
   - 用户管理、商品管理
✅ 非功能需求：5个
   - 性能：响应时间<2秒
   - 安全：数据加密、权限控制
   - 可用性：99.9%可用性
✅ 用户角色：4个
   - 客户、商家、管理员、系统管理员
✅ 数据实体：8个
   - 订单、商品、用户、支付、库存等

第2步：用户故事生成
AI：@user-story-generator 基于需求分析生成用户故事...

生成结果：
✅ 用户故事：36个
✅ Sprint计划：3个Sprint
✅ 总故事点：72点

第3步：架构设计
AI：@architecture-designer 设计系统架构...

设计结果：
✅ 架构模式：分层架构（复杂度：中等）
✅ 技术栈：Spring Boot + OceanBase + Vue.js
✅ 部署方案：Docker + Nginx
✅ 质量属性：性能、安全、可维护性

第4步：代码生成（新项目跳过架构识别）
AI：@intelligent-code-generator 基于架构设计生成代码...

生成结果：
✅ 订单管理模块完整代码
✅ 用户管理模块完整代码
✅ 商品管理模块完整代码
✅ 数据库建表脚本
✅ 配置文件

第5步：测试生成
AI：@test-generator 生成测试用例...

生成结果：
✅ 单元测试：覆盖率85%
✅ 集成测试：主要业务流程
✅ API测试：所有接口
✅ 测试数据：模拟数据生成
```

### 场景2：现有项目新功能开发

#### 智能架构识别流程
```
用户：我要在现有的Spring Boot项目中添加订单管理功能

第1步：架构识别（关键步骤）
AI：@project-architecture-analyzer 分析现有项目架构...

识别结果：
✅ 项目类型：Spring Boot Maven项目
✅ 架构模式：分层架构（置信度：85%）
✅ 分层结构：
   - Controller: com.example.ecommerce.controller
   - Service: com.example.ecommerce.service
   - Repository: com.example.ecommerce.repository
   - Entity: com.example.ecommerce.entity
✅ 命名约定：
   - 类名：PascalCase (UserController, UserService)
   - 方法名：camelCase (findById, saveUser)
   - 包名：小写点分隔
✅ 注解风格：
   - @RestController, @Service, @Repository
   - @Entity, @Table, @Column
   - @Valid, @RequestBody, @PathVariable
✅ 数据库规范：
   - 表名：snake_case (user_info, product_catalog)
   - 字段：snake_case (created_at, updated_at)
   - 主键：统一使用id，Long类型

第2步：需求分析
AI：@requirements-analyzer 分析订单管理需求...

第3步：智能代码生成
AI：@intelligent-code-generator 基于现有架构生成订单管理代码...

生成策略：
✅ 遵循现有包结构：com.example.ecommerce.xxx
✅ 使用现有命名约定：OrderController, OrderService
✅ 应用现有注解风格：@RestController, @Service
✅ 遵循数据库规范：orders表，snake_case字段

生成结果：
📁 com/example/ecommerce/controller/
   └── OrderController.java (完美匹配现有Controller风格)

📁 com/example/ecommerce/service/
   └── OrderService.java (遵循现有Service模式)

📁 com/example/ecommerce/repository/
   └── OrderRepository.java (使用现有Repository接口)

📁 com/example/ecommerce/entity/
   └── Order.java (符合现有Entity注解风格)

第4步：代码质量检查
AI：@code-standard-checker 检查生成代码质量...

检查结果：
✅ 命名规范：100%符合
✅ 架构规范：100%符合
✅ 安全规范：通过验证
✅ 文档规范：JavaDoc完整

第5步：测试生成
AI：@test-generator 生成测试用例...

测试结果：
✅ OrderControllerTest.java - Web层测试
✅ OrderServiceTest.java - 业务层测试
✅ OrderRepositoryTest.java - 数据层测试
✅ OrderIntegrationTest.java - 集成测试
```

## 🎯 核心优势

### 1. 智能架构适应
- **自动识别**：智能识别现有项目架构模式
- **完美融合**：生成的代码100%符合现有风格
- **零调整**：无需手工修改，直接可用

### 2. 全流程覆盖
- **需求到代码**：完整的开发生命周期
- **质量保证**：每个阶段都有质量检查
- **文档齐全**：自动生成各类文档

### 3. 多架构支持
- **分层架构**：传统三层架构
- **微服务架构**：独立服务模块
- **六边形架构**：端口适配器模式
- **DDD架构**：领域驱动设计

## 📊 工具链配置

### Trae IDE 配置
将 `config/完整开发流程MCP配置.json` 添加到 Trae IDE：

```json
// 在 Trae IDE 设置中添加
{
  "mcpServers": {
    // 复制配置文件中的内容
  }
}
```

### 工作流配置
系统预定义了两个工作流：

#### 1. 完整开发流程 (complete_development_flow)
适用于全新项目开发，包含所有5个阶段。

#### 2. 新功能开发 (new_feature_development)
适用于现有项目新功能开发，重点关注架构识别。

## 🔧 高级配置

### 自定义架构识别规则
在 `mcp-tools/03-architecture/项目架构识别MCP工具.py` 中：

```python
# 调整置信度阈值
CONFIDENCE_THRESHOLD = 60  # 默认60%

# 添加新的架构模式识别
def _detect_custom_architecture(self):
    # 自定义架构识别逻辑
    pass
```

### 自定义代码生成模板
在 `templates/` 目录中添加自定义模板：

```
templates/
├── layered-architecture/
│   ├── controller.java.template
│   ├── service.java.template
│   └── repository.java.template
└── custom-architecture/
    └── custom.java.template
```

## 🚨 最佳实践

### 1. 架构识别准确性
- **项目完整性**：确保项目结构完整
- **代码示例**：包含足够的代码示例
- **置信度检查**：验证识别结果的置信度

### 2. 代码生成质量
- **规范遵循**：严格遵循识别出的编码规范
- **测试覆盖**：确保生成的代码有对应测试
- **文档完整**：生成完整的代码文档

### 3. 持续优化
- **反馈收集**：收集使用过程中的问题
- **模板更新**：定期更新代码生成模板
- **规则优化**：优化架构识别规则

## 📈 效果评估

### 开发效率提升
- **需求分析**：自动化程度90%
- **代码生成**：提升效率80%
- **测试创建**：自动生成覆盖率85%

### 代码质量保证
- **架构一致性**：100%符合现有架构
- **编码规范**：100%符合项目规范
- **文档完整性**：自动生成完整文档

### 团队协作改善
- **标准化**：统一的开发流程和代码风格
- **知识传承**：新人快速上手现有项目
- **质量稳定**：减少人为错误和不一致

这套完整的开发流程 MCP 工具链将显著提升您的开发效率和代码质量！
